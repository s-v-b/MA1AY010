---
#title: "Exercices supplémentaires: semaine I"
# subtitle: "M1 ISIFAR MA1AY010"

# date: "2025-09-08"

format:
  pdf:
    output-file: td1-supplement.pdf
    class: exam
    include-in-header:
      - text: "\\lhead{{\\sf  Probabilités \\\\ TD 1 Supplément}}"
  html:
    output-file: td1-supplement.html

engine: knitr
---



```{r}
#| echo: false
#| eval: true

cnt_exo <- 1
```


::: {.callout-note}

### TD I : Révisions de Licence (exercices supplémentaires)

- 8 Septembre 2025-12 Septembre 2025

- Master I Isifar

- **Probabilités** 

:::

## Pour aller plus loin

### Exercice `r cnt_exo` (un (contre)-exemple à garder en tête)

```{r}
#| eval: true    # true si l'exercice est visible 
#| echo: false
cnt_exo <-  cnt_exo + 1
```

On note $C$ l'*ensemble de Cantor*, qui est obtenu, récursivement, en enlevant $I_1^{(1)} : = (1/3,2/3)$ à l'intervalle $[0,1]$, puis en enlevant les tiers intermédiaires $I_2^{(1)} = (1/9,2/9), I_2^{(2)}= (7/9,8/9)$ des deux intervalles restants, et ainsi de suite, de sorte qu'à l'etape $n$ on enlève  $2^{n-1}$ intervalles tous de taille $1/3^n$, notés $I_n^{(j)},j=1...2^{n-1}$. 

On définit la fonction croissante :

$$F(x) := \begin{cases}  0 & \text{ si } x \le 0 \\    1 & \text{ si } x \ge 1 \\ \frac{2j-1}{2^n} \text{ si } x \in I_n^{(j)}. \end{cases}$$


1. La fonction $F$ est-elle continue? 
2. Dans quel ensemble la variable $X$, de fonction de répartition $F$ ---définie ci-dessus--- prend elle ses valeurs? Que vaut $\mathbb{E}[X]$? Que vaut $\mathbb{P}(|X-\mathbb{E}[X]|<1/8)$? Pour $x \in C$, que vaut $\mathbb{P}(X=x)$? 
3. Justifier que la variable $X$ est uniforme sur $C$. Admet-elle une densité sur $[0,1]$?   
4. Quelle est la loi de $Y=F(X)$? 
5. Pourrait-on ainsi définir une variable aléatoire uniforme sur $\mathbb{Q}\cap [0,1]$?
6. Soient $\{X_j, j \in \mathbb{N}^* \}$ une famille de variables i.i.d., distribuées suivant la loi de Bernoulli de parmaètre $1/2$. On définit $X=2 \sum_{j \ge 1} \frac{X_j}{3^j}$. Quelle est la loi de $X$? 
7. Calculer $\Phi_X$ et montrer qu'elle est constante sur $\{3^k \pi, k \in \mathbb{N}^* \}$.
 




### Exercice `r cnt_exo`

```{r}
#| eval: true
#| echo: false
cnt_exo <-  cnt_exo + 1
```

Dans ce qui suit $||.||$ désigne la norme euclidienne. 

Pour $\varepsilon \in (0,1)$, $n \in \mathbb{N}$  
on note $A_{n, \varepsilon} := \{ x \in \mathbb{R}^n : (1-\varepsilon)(n/3)^{1/2} \le ||x|| \le (1+\varepsilon)(n/3)^{1/2}\}$, 
et $C_n=[-1,1]^n$. 

Montrer que pour tout $\varepsilon \in (0,1)$, la mesure de Lebesgue de $C_n \cap A_{n, \varepsilon}^c$ est négligeable, pour $n \to \infty$, devant celle de $C_n$.   

 *Indication* : On notera qu'un point générique dans $C_n$ a pour coordonnées $(X_1,...,X_n)$, avec $\{X_i, i \ge 1\}$ une famille de variables aléatoires i.i.d, uniformes sur $[-1,1]$.  

*Note* : Ceci signifie que pour $\varepsilon$ aussi petit qu'on souhaite le prendre, lorsque $n$ est grand, la majeure partie du volume de l'hypercube $C_n$ se trouve dans la couronne $A_{n,\varepsilon}$ (!) 


### Exercice `r cnt_exo`

```{r}
#| eval: true
#| echo: false
cnt_exo <-  cnt_exo + 1
```

 

Soit $X \sim \Gamma(1,s)$. On définit $Y \sim \mathrm{Poisson}(X)$, (c'est-à-dire que conditionnellement à $X=x$, $Y \sim \mathrm{Poisson}(x)$). 
 
1. Calculer $\Phi_Y$.
1. Montrer que lorsque $s \to \infty$, 
$$\frac{Y-E[Y]}{\sqrt{\mathrm{var}(Y)}} \overset{(\mathrm{loi})}{\longrightarrow} Z,$$ 
où $Z \sim \mathcal{N}(0,1)$. Y a-t-il un lien avec le théorème central limite? 
 

### Exercice `r cnt_exo`

```{r}
#| eval: true
#| echo: false
cnt_exo <-  cnt_exo + 1
```

 (Une remarque importante sur la convergence en loi.)

Soit, pour $n \ge 1$, $X_n$ un variable aléatoire dont la fonction de répartition est définie par
$$ F_n(x) = x - \frac{\sin(2n \pi x)}{2n\pi}, \ 0 \le x \le 1.$$
 
1. Montrer que $X_n$ converge en loi vers une variable $X$ (dont on décrira la loi).  
1.  Vérifier que $X_n$ et $X$ sont des variables à densité. On note $f_n := F_n'$ la densité de $X_n$, $f$ celle de $X$. A-t-on $f_n \underset{n \to \infty}{\rightarrow} f$ simplement?    




### Exercice `r cnt_exo`

```{r}
#| eval: true
#| echo: false
cnt_exo <-  cnt_exo + 1
```

 (Le problème des anniversaires)

On cherche a approximer la probabilité que parmi $N$ personnes, au moins deux (resp. trois) aient leur anniversaire le même jour. 

1. Pour $1 \le i <j \le N$, on note $E_{ij}$ l'événement que les personnes $i,j$ aient le même anniversaire. Quelle est la probabilité de $E_{ij}$? Dans la suite de l'exercice on omet de considérer le cas des $29$ février.  Que vaut alors $P(E_{ij})$? Montrer que les événements $E_{12}, E_{23}, E_{13}$ sont indépendants deux à deux, mais pas mutuellement indépendants. Exprimer la probabilité qu'il y ait au moins deux personnes qui aient leur anniversaire le même jour. 
1. Le but de cette question n'est pas d'obtenir un résultat exact, mais de faire une approximation assez bonne de la probabilité que parmi $N$ personnes, il y en ait au moins deux qui partagent le même anniversaire. On *admettra* donc que dans la suite on fait  *l'approximation* que les $\{E_{ij}, 1 \le i < j \le N\}$ sont mutuellement  indépendants. Quelle est alors la loi du nombre de couples ayant le même anniversaire? Approximer le résultat pour $N=30, N=60$.  
1. Par une méthode similaire, approximer la probabilité que parmi $60$ personnes, il y en ait au moins trois qui ont leur anniversaire le même jour. Finalement, approximer la probabilité de cet événement lorsque $N=90$. 


### Exercice `r cnt_exo`

```{r}
#| eval: true
#| echo: false
cnt_exo <-  cnt_exo + 1
```

 (Quelques variantes du modèle de branchement aléatoire)

On considère le modèle de branchement aléatoire qui est un modèle pour l'évolution d'une population haploïde. 

On part initialement de $Z_0$ ancêtres, et on note $Z_n$ le nombre total d'individus de la génération $n$. 

On fait l'hypothèse (pas très réaliste) que tous les individus ont exactement le même temps de vie (disons $1$), et que de plus deux générations distinctes ne cohabitent pas. Ainsi chacun des ancêtre meurt au temps $1$, et donne naissance à un nombre aléatoire d'individus, de façon *indépendante* de ses contemporains. Tous les individus qui sont nés au temps $1$ forment la génération $1$. La génération $1$ meurt au temps $2$ en donnant  naissance à la génération $2$, etc...

Formellement, on se donne une *loi de branchement* $\nu$ sur les entiers positifs, telle que $\nu(1)< 1$ et $\sum_{k \ge 0} k \nu(k) = \mu \in [0,\infty)$ On introduit alors une famille $(X,X_{i,k}, i \ge 0, k\ge 1)$ de variables aléatoires i.i.d, toutes de loi $\mu$. Si jamais la génération $i$ possède un $k$-ième individu, $X_{i,k}$ désigne le nombre de ses descendants. 

 
1. Pour $n \ge 1$, exprimer $Z_n$ en fonction de $Z_{n-1}$ et des $(X_{n-1,k}, k \ge 1)$. 
2. On note $G_{X}(t) = E[t^{X}]$, $G_{Z_n}(t) = E[t^{Z_n}]$ (qui ne sont autres, modulo un simple changement de variable, que les fonctions génératrice des moments de $X$, $Z_n$). 
Exprimer $G_{Z_n}$ en fonction de $G_X, G_{Z_0}$. 
1. On note $\zeta$ le probabilité d'extinction. A quelle condition sur $\mu$ a-t-on $\zeta=1$ p.s.?   
*Indication* : On pourra considérer la suite $\zeta_n = \mathbb{P}(Z_n=0)$
1. Une première *martingale*, Calculer $\mathbb{E}[Z_{n-1}|Z_n]$. On pose $M_{n}=Z_n/\mu^n$. Calculer $\mathbb{E}[M_{n+1}|M_n]$.  

Pour plus de détails, on pourra voir l'introduction du livre de D.WILLIAMS, *Probability with martingales*, Cambridge University Press, 1991.
 




1. On considère (dans cette question uniquement) un processus de branchement avec immigration. On garde la même dynamique : à sa mort, un individu donne naissance à un nombre al\'atoire de descendants suivant la loi $\mu$. De plus, chaque génération voit maintenant arriver un nombre aléatoire d'immigrants, indistinguables des individus déjà présents.  
Formellement, on se donne une loi $\nu$ sur $\mathbb{N}$ et on introduit $Y,Y_1,...Y_n$ des variables $i.i.d.$ de loi $\nu$. La génération $n$ reçoit $Y_n$ individus au temps $n$. 
  On note $G_Y(t)= E[t^{Y}]$. Trouver une relation entre $G_{Z_n}, G_Y$ et $G_{Z_0}$. 

1. Enfin, on considère un processus de branchement dont les individus n'ont pas tous un temps de vie égal à $1$. Pour simplifier un peu, on va  seulement considérer la descendance d'un unique ancêtre, i.e. on pose $Z_0=1$. \\ Formellement, on se donne une loi $P_{T}$ sur $\mathbb{R}_+$, dont la densité est notée $f_T$. On définit famille de variables aléatoires $(T_{i}, i \in \mathbb{N})$ i.i.d, de loi $P_T$. On peut numéroter les individus en les classant suivant leur date de naissance. On définit alors $T_i$ comme le temps de vie du $i$-ième individu.  
   
    Pour $t \ge 0$, on note $Z_t$ le nombre total d'individus qui sont en vie au temps $t$. On note enfin $G_t(s) = E[s^{Z_t}]$. 


- Montrer que $G_t(s) = \int_0^{\infty} E[s^{Z_t} |T_0 =u] f_T(u) du$  
- En déduire
$$ G_t(s) = \int_0^t G_X(G_{t-u}(s))f_T(u) du + \int_t^{\infty} sf_T(u) du.$$   
- Dans le cas où $f_T(s)= \lambda \exp(-\lambda s)$, montrer alors que 
$$\frac{\partial t}{\partial t} G_t(s) = \lambda \left[ G_X(G_t(s)) - G_t(s)\right]  $$





